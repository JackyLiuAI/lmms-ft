# å®ç°æœ€æ–°mllmsçš„å¾®è°ƒ

æ´»è·ƒç»´æŠ¤è€…ï¼š[Yuqian Hong](https://github.com/lavinal712)

åˆå§‹ç»´æŠ¤è€…ï¼š[Jingyang Zhang](https://github.com/zjysteven)ã€[Yueqian Lin](https://github.com/linyueqian)

## å…³äº

è¶Šæ¥è¶Šå¤šçš„å¤§å‹å¤šæ¨¡æ€æ¨¡å‹ (LMM) ä¸æ–­å‘å¸ƒï¼Œä½†è¿™äº›æ¨¡å‹çš„å¾®è°ƒå¹¶ä¸æ€»æ˜¯é‚£ä¹ˆç®€å•ã€‚æ­¤ä»£ç åº“æ—¨åœ¨ä¸º LMM å¾®è°ƒæä¾›ç»Ÿä¸€ã€ç²¾ç®€çš„ç»“æ„ã€‚å…³é”®è®¾è®¡ç†å¿µåŒ…æ‹¬ï¼š

- å¾®è°ƒè¿‡ç¨‹çš„ç»„ä»¶ï¼ˆä¾‹å¦‚ï¼Œæ¨¡å‹åŠ è½½ã€æ•°æ®æ•´ç†ï¼‰è¢«æŠ½è±¡å‡ºæ¥ï¼Œä»è€Œå…è®¸äººä»¬è½»æ¾åœ°å°†æœ€æ–°çš„ LMM é›†æˆåˆ°è¯¥ä»£ç åº“ä¸­ï¼Œå¹¶ä»¥æœ€å°çš„åŠªåŠ›å¯¹å…¶è¿›è¡Œå¾®è°ƒï¼›
- å¯¹äºæ‰€æœ‰ LMMï¼Œéƒ½ä½¿ç”¨ğŸ¤—huggingface çš„å®˜æ–¹å®ç°ï¼Œä»¥ä¾¿åœ¨å¾®è°ƒä¹‹åå¯ä»¥ä»¥ä¸ä¹‹å‰ä½¿ç”¨ HF æ¨¡å‹å®Œå…¨ç›¸åŒçš„æ–¹å¼è¿›è¡Œæ¨ç†å’Œå…¶ä»–æ‰€æœ‰æ“ä½œï¼›
- ä»£ç åº“å°½å¯èƒ½ä¿æŒç®€å•/è½»é‡ï¼Œä»¥ä¾¿äºç†è§£å’Œä¿®æ”¹ã€‚

è¯¥ä»£ç åº“éå¸¸çµæ´»ã€‚å®ƒæ”¯æŒå„ç§ç±»å‹çš„ LMM çš„å¾®è°ƒï¼ŒåŒ…æ‹¬ï¼š

- ğŸŒ‡ å•å›¾åƒæ¨¡å‹ï¼š[LLaVA-1.5](https://huggingface.co/collections/llava-hf/llava-15-65f762d5b6941db5c2ba07e0)ã€[LLaVA-1.6/NeXT](https://huggingface.co/collections/llava-hf/llava-next-65f75c4afac77fd37dbbe6cf)ã€[Phi-3-Vision](https://huggingface.co/microsoft/Phi-3-vision-128k-instruct)ã€[Llama-3.2-Vision](https://huggingface.co/meta-llama/Llama-3.2-11B-Vision)
- ğŸ“‘ å¤šä¸ª/äº¤é”™å›¾åƒæ¨¡å‹ï¼š[Qwen-VL-Chat](https://huggingface.co/Qwen/Qwen-VL-Chat)ã€[Qwen2-VL-Instruct](https://huggingface.co/Qwen/Qwen2-VL-7B-Instruct)ã€ [LLaVA-NeXT-Interleave](https://huggingface.co/collections/llava-hf/llava-interleave-668e19a97da0036aad4a2f19)ã€[Qwen2.5-VL-Instruct](https://huggingface.co/Qwen/Qwen2.5-VL-3B-Instruct)
- ğŸ¥ è§†é¢‘æ¨¡å‹ï¼š[LLaVA-NeXT-Video](https://huggingface.co/collections/llava-hf/llava-next-video-6666a9173a64c7052930f153)
- ğŸš€ ç»Ÿä¸€æ¨¡å‹ï¼š[LLaVA-Onevision](https://huggingface.co/collections/llava-hf/llava-onevision-66bb1e9ce8856e210a7ed1fe)

è¯·å‚é˜…[supported_models.md](https://github.com/JackyLiuAI/lmms-ft/blob/main/docs/supported_models.md)ï¼ŒæŸ¥çœ‹å—æ”¯æŒæ¨¡å‹çš„å®Œæ•´åˆ—è¡¨ã€‚è®­ç»ƒç­–ç•¥æ–¹é¢ï¼ŒLLM ç»„ä»¶æ”¯æŒ 1) full-finetuningã€2) lora å’Œ 3) q-loraï¼›è§†è§‰ç¼–ç å™¨/ä¸»å¹²ç½‘æ”¯æŒ 1) full-finetuning å’Œ 2) loraã€‚

<details open="" style="box-sizing: border-box; display: block; margin-top: 0px; margin-bottom: 16px;"><summary style="box-sizing: border-box; display: list-item; cursor: pointer;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ä¸å…¶ä»–è®­ç»ƒæ¡†æ¶ï¼ˆä¾‹å¦‚ LLaMA-Factoryã€xtunerã€swiftï¼‰æœ‰ä½•ä¸åŒï¼Ÿ</font></font></summary><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">è¿™äº›éƒ½æ˜¯è§„æ¨¡åºå¤§ã€ä¼˜åŒ–ç¨‹åº¦æé«˜çš„é¡¹ç›®/æ¡†æ¶ï¼Œéå¸¸å‡ºè‰²ã€‚ç„¶è€Œï¼Œç”±äºå…¶è§„æ¨¡å’Œå¤æ‚æ€§ï¼Œå®ƒä»¬å¯èƒ½ä¸å¤Ÿé€æ˜ï¼Œä¸Šæ‰‹éš¾åº¦ä¹Ÿæ¯”è¾ƒé«˜ï¼ˆä¾‹å¦‚ï¼Œæˆ‘ä¸ªäººåœ¨å°è¯•ä½¿ç”¨è¿™äº›æ¡†æ¶æ—¶ä¼šæ„Ÿåˆ°å¾ˆè¿·èŒ«ï¼Œæ€»æ˜¯ä¼šé—®è‡ªå·±â€œåº”è¯¥å¦‚ä½•æ ¼å¼åŒ–æ•°æ®â€ä¹‹ç±»çš„é—®é¢˜ï¼‰ã€‚è€Œè¿™ä¸ªä»£ç åº“ (lmms-finetune) åˆ™ä»¥è½»é‡çº§å’Œç®€æ´ä¸ºè®¾è®¡ç†å¿µï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥æ›´å¿«é€Ÿåœ°ä¸Šæ‰‹ï¼Œå¹¶æ ¹æ®éœ€è¦äº†è§£è®­ç»ƒè¿‡ç¨‹çš„å‡ ä¹æ‰€æœ‰ç»†èŠ‚ã€‚æ¢å¥è¯è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªæç®€å¯è¡Œä»£ç åº“ï¼Œå®ƒæ”¯æŒ LMM å¾®è°ƒï¼ŒåŒæ—¶æ–¹ä¾¿å¿«é€Ÿå®éªŒã€çµæ´»ä¿®æ”¹ä»¥åŠè½»æ¾é›†æˆæ–°æ¨¡å‹ã€‚</font></font></p></details>

## æ¶ˆæ¯

- **2025/01/27**ï¼šæ­¤åˆ†æ”¯æ”¯æŒ Qwen2.5 ç³»åˆ—`transformers-4.49.0.dev0`ã€‚ç›®å‰æ‚¨éœ€è¦ä» GitHub å®‰è£…æœ€æ–°çš„ Transformersã€‚
- **2024/12/16 ï¼šæ„Ÿè°¢**[lavinal712 (Yuqian)](https://github.com/lavinal712)çš„è´¡çŒ®ï¼Œç°åœ¨æ”¯æŒä½¿ç”¨ Llama-3.2-Vision è¿›è¡Œè®­ç»ƒã€‚æ­¤å¤–ï¼Œè¿˜æ·»åŠ äº†ä¸€ä¸ªå®ç”¨è„šæœ¬`merge_lora_weights.py`ã€‚
- **2024å¹´10æœˆ16æ—¥**ï¼šæˆ‘ä»¬æ·»åŠ äº†LLaVA-Onevisionã€‚ä½¿ç”¨LLaVA-Onevisionçš„æ³¨æ„äº‹é¡¹è¯·è§[æ­¤å¤„](https://github.com/zjysteven/lmms-finetune/issues/43)ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜æ›´æ–°äº†æ’åºå™¨ï¼Œä»¥ä¸Transformerä¸­LLaVAæ¨¡å‹çš„æ–°å¤„ç†æ–¹å¼ä¿æŒä¸€è‡´ã€‚
- **2024/08/28**ï¼šæ”¯æŒä½¿ç”¨ gradio webui ç•Œé¢è¿›è¡Œå¾®è°ƒã€‚å°è¯•ä¸€ä¸‹`python webui.py`ã€‚
- **2024/07/30**ï¼šç°åœ¨æ”¯æŒè§†è§‰ç¼–ç å™¨å’ŒæŠ•å½±ä»ªçš„å¾®è°ƒã€‚
- **2024/07/25**ï¼šå¤šé¡¹æ”¹è¿›ã€‚æˆ‘ä»¬*1ï¼‰*å‘å¸ƒäº†ä¸€ä¸ª[Colab ç¬”è®°æœ¬ï¼Œ](https://colab.research.google.com/drive/139XypY8_wdLgyLXYE_Zve7Hjd809fVpK?usp=sharing)æ¼”ç¤ºäº†ä½¿ç”¨ LLaVA-NeXT-Video-7B è¿›è¡Œå®Œæ•´ä¸”æˆåŠŸçš„è®­ç»ƒè¿è¡Œï¼ˆå¾ˆé«˜å…´å¬åˆ°å¤§å®¶ä¹Ÿè¡¨ç¤ºä»–ä»¬[çš„æ¡ˆä¾‹](https://github.com/zjysteven/lmms-finetune/issues/7#issuecomment-2249864887)å–å¾—äº†æˆåŠŸï¼‰ï¼›*2ï¼‰*æ”¯æŒåœ¨è®­ç»ƒé›†ä¸­ä½¿ç”¨çº¯æ–‡æœ¬æ ·æœ¬ï¼ˆè¯¦æƒ…è¯·å‚é˜…[æ­¤å¤„ï¼‰ã€‚](https://github.com/JackyLiuAI/lmms-ft/blob/main/docs/dataset.md)
- **2024/07/20**ï¼šä»£ç åº“é¦–æ¬¡å‘å¸ƒã€‚æ›´å¤šæ¨¡å‹å’Œä¼˜åŒ–å³å°†æ¨å‡ºã€‚æ•¬è¯·æœŸå¾…ï¼

## å®‰è£…

```sh
# clone this repo
git clone https://github.com/zjysteven/lmms-finetune.git

# set up a conda environment
conda create -n lmms-finetune python=3.10 -y
conda activate lmms-finetune
## this will install the latest version of torch
## feel free to change it to a specific version
python -m pip install -r requirements.txt

## optionally install flash attention
python -m pip install --no-cache-dir --no-build-isolation flash-attn
```

## ç”¨æ³•

[æ­¤Colab ç¬”è®°æœ¬](https://colab.research.google.com/drive/139XypY8_wdLgyLXYE_Zve7Hjd809fVpK?usp=sharing)å±•ç¤ºäº†ä¸€ä¸ªå¯è¡Œçš„è®­ç»ƒç¤ºä¾‹ï¼ˆLLaVA-NeXT-Video-7Bï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨äº†è§£å¦‚ä½•ä½¿ç”¨æ­¤ä»£ç åº“ã€‚ä»¥ä¸‹éƒ¨åˆ†å°†æä¾›æœ‰å…³å¦‚ä½•å¾®è°ƒæ¨¡å‹çš„æ›´è¯¦ç»†æŒ‡å—ã€‚

<details open="" style="box-sizing: border-box; display: block; margin-top: 0px; margin-bottom: 16px;"><summary style="box-sizing: border-box; display: list-item; cursor: pointer;"><b style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">0.æŸ¥çœ‹ä½ æƒ³è¦å¾®è°ƒçš„æ¨¡å‹æ˜¯å¦å—æ”¯æŒ</font></font></b></summary><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æµè§ˆ</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/docs/supported_models.md" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">supported_models.md</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ã€‚æˆ–è€…è¿è¡Œ</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">python supported_models.py</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ï¼Œä¾‹å¦‚ï¼Œå®ƒå°†æ˜¾ç¤ºä»¥ä¸‹å†…å®¹</font></font></p><div class="snippet-clipboard-content notranslate position-relative overflow-auto" style="box-sizing: border-box; position: relative !important; overflow: auto !important; display: flex; justify-content: space-between; margin-bottom: 16px; background-color: rgb(246, 248, 250);"><pre class="notranslate" style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; overflow-wrap: normal; padding: 16px; overflow: auto; line-height: 1.45; color: rgb(31, 35, 40); background-color: rgb(246, 248, 250); border-radius: 6px;"><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0px; margin: 0px; white-space: pre; background: rgba(0, 0, 0, 0); border-radius: 6px; word-break: normal; border: 0px; display: inline; overflow: visible; line-height: inherit; overflow-wrap: normal;">Supported models:
  Model ID                      : HuggingFace Path
  ------------------------------------------------
  llava-1.5-7b                  : llava-hf/llava-1.5-7b-hf
  llava-1.5-13b                 : llava-hf/llava-1.5-13b-hf
  llava-next-video-7b           : llava-hf/LLaVA-NeXT-Video-7B-hf
  llava-next-video-7b-32k       : llava-hf/LLaVA-NeXT-Video-7B-32K-hf
  llava-next-video-34b          : llava-hf/LLaVA-NeXT-Video-34B-hf
  llava-interleave-qwen-0.5b    : llava-hf/llava-interleave-qwen-0.5b-hf
  llava-interleave-qwen-7b      : llava-hf/llava-interleave-qwen-7b-hf
  llava-onevision-0.5b-ov       : llava-hf/llava-onevision-qwen2-0.5b-ov-hf
  llava-onevision-7b-ov         : llava-hf/llava-onevision-qwen2-7b-ov-hf
  llava-onevision-72b-ov        : llava-hf/llava-onevision-qwen2-72b-ov-hf
  qwen-vl-chat                  : Qwen/Qwen-VL-Chat
  phi3-v                        : microsoft/Phi-3-vision-128k-instruct
  qwen2-vl-2b-instruct          : Qwen/Qwen2-VL-2B-Instruct
  qwen2-vl-7b-instruct          : Qwen/Qwen2-VL-7B-Instruct
  llama-3.2-11b-vision-instruct : meta-llama/Llama-3.2-11B-Vision-Instruct
  llama-3.2-90b-vision-instruct : meta-llama/Llama-3.2-90B-Vision-Instruct
</code></pre><div class="zeroclipboard-container" style="box-sizing: border-box; display: block; animation: auto ease 0s 1 normal none running none;"><clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="Supported models:
  Model ID                      : HuggingFace Path
  ------------------------------------------------
  llava-1.5-7b                  : llava-hf/llava-1.5-7b-hf
  llava-1.5-13b                 : llava-hf/llava-1.5-13b-hf
  llava-next-video-7b           : llava-hf/LLaVA-NeXT-Video-7B-hf
  llava-next-video-7b-32k       : llava-hf/LLaVA-NeXT-Video-7B-32K-hf
  llava-next-video-34b          : llava-hf/LLaVA-NeXT-Video-34B-hf
  llava-interleave-qwen-0.5b    : llava-hf/llava-interleave-qwen-0.5b-hf
  llava-interleave-qwen-7b      : llava-hf/llava-interleave-qwen-7b-hf
  llava-onevision-0.5b-ov       : llava-hf/llava-onevision-qwen2-0.5b-ov-hf
  llava-onevision-7b-ov         : llava-hf/llava-onevision-qwen2-7b-ov-hf
  llava-onevision-72b-ov        : llava-hf/llava-onevision-qwen2-72b-ov-hf
  qwen-vl-chat                  : Qwen/Qwen-VL-Chat
  phi3-v                        : microsoft/Phi-3-vision-128k-instruct
  qwen2-vl-2b-instruct          : Qwen/Qwen2-VL-2B-Instruct
  qwen2-vl-7b-instruct          : Qwen/Qwen2-VL-7B-Instruct
  llama-3.2-11b-vision-instruct : meta-llama/Llama-3.2-11B-Vision-Instruct
  llama-3.2-90b-vision-instruct : meta-llama/Llama-3.2-90B-Vision-Instruct" tabindex="0" role="button" style="box-sizing: border-box; position: relative; display: flex !important; padding: 0px !important; font-size: 14px; font-weight: 500; line-height: 20px; white-space: nowrap; vertical-align: middle; cursor: pointer; user-select: none; border: 0px; border-radius: 6px; appearance: none; color: rgb(9, 105, 218); background-color: rgba(0, 0, 0, 0); box-shadow: none; transition: color 80ms cubic-bezier(0.33, 1, 0.68, 1), background-color, box-shadow, border-color; justify-content: center !important; align-items: center !important; margin: 8px !important; width: 28px; height: 28px;"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon"></svg></clipboard-copy></div></div><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">âœ‹ æ²¡æœ‰çœ‹åˆ°ä½ æƒ³è¦çš„æ¨¡å‹ï¼ŸæŸ¥çœ‹æœ¬</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/docs/add_new_model.md" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æŒ‡å—</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ï¼Œäº†è§£å¦‚ä½•æ·»åŠ æ–°æ¨¡å‹çš„åˆ†æ­¥è¯´æ˜ã€‚</font></font></p></details>

<details open="" style="box-sizing: border-box; display: block; margin-top: 0px; margin-bottom: 16px;"><summary style="box-sizing: border-box; display: list-item; cursor: pointer;"><b style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">1. å‡†å¤‡å¾®è°ƒæ•°æ®</font></font></b></summary><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ä¸ LLaVA ç±»ä¼¼ï¼Œæˆ‘ä»¬å¸Œæœ›æ•°æ®ä½äºåŒ…å«å­—å…¸åˆ—è¡¨çš„ json æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªå­—å…¸éƒ½æ˜¯ä¸€ä¸ªæ ·æœ¬ã€‚</font></font></p><div class="highlight highlight-source-json notranslate position-relative overflow-auto" dir="auto" style="box-sizing: border-box; position: relative !important; overflow: auto !important; margin-bottom: 16px; display: flex; justify-content: space-between; background-color: rgb(246, 248, 250);"><pre style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; overflow-wrap: normal; padding: 16px; overflow: auto; line-height: 1.45; color: rgb(31, 35, 40); background-color: rgb(246, 248, 250); border-radius: 6px; word-break: normal; min-height: 52px;">[
    {
        <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"system_prompt"</span>: <span class="pl-s" style="box-sizing: border-box; color: rgb(10, 48, 105);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span>You are a helpful assistant.<span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span></span>,
        <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"video"</span>: <span class="pl-s" style="box-sizing: border-box; color: rgb(10, 48, 105);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span>path/to/video1.mp4<span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span></span>,
        <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"conversations"</span>: [
            {
                <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"from"</span>: <span class="pl-s" style="box-sizing: border-box; color: rgb(10, 48, 105);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span>human<span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span></span>,
                <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"value"</span>: <span class="pl-s" style="box-sizing: border-box; color: rgb(10, 48, 105);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span>&lt;video&gt;What is this video about?<span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span></span>
            },
            {
                <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"from"</span>: <span class="pl-s" style="box-sizing: border-box; color: rgb(10, 48, 105);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span>gpt<span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span></span>,
                <span class="pl-ent" style="box-sizing: border-box; color: rgb(5, 80, 174);">"value"</span>: <span class="pl-s" style="box-sizing: border-box; color: rgb(10, 48, 105);"><span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span>This video shows a baby crying.<span class="pl-pds" style="box-sizing: border-box; color: rgb(10, 48, 105);">"</span></span>
            },
        ]
    }
]</pre><div class="zeroclipboard-container" style="box-sizing: border-box; display: block; animation: auto ease 0s 1 normal none running none;"><clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="[
    {
        &quot;system_prompt&quot;: &quot;You are a helpful assistant.&quot;,
        &quot;video&quot;: &quot;path/to/video1.mp4&quot;,
        &quot;conversations&quot;: [
            {
                &quot;from&quot;: &quot;human&quot;,
                &quot;value&quot;: &quot;<video>What is this video about?&quot;
            },
            {
                &quot;from&quot;: &quot;gpt&quot;,
                &quot;value&quot;: &quot;This video shows a baby crying.&quot;
            },
        ]
    }
]" tabindex="0" role="button" style="box-sizing: border-box; position: relative; display: flex !important; padding: 0px !important; font-size: 14px; font-weight: 500; line-height: 20px; white-space: nowrap; vertical-align: middle; cursor: pointer; user-select: none; border: 0px; border-radius: 6px; appearance: none; color: rgb(9, 105, 218); background-color: rgba(0, 0, 0, 0); box-shadow: none; transition: color 80ms cubic-bezier(0.33, 1, 0.68, 1), background-color, box-shadow, border-color; justify-content: center !important; align-items: center !important; margin: 8px !important; width: 28px; height: 28px;"><svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon"></svg></clipboard-copy></div></div><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">å›¾åƒå’Œè§†é¢‘æ ‡è®°å‡å®šä¸º</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">&lt;image&gt;</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">å’Œ</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">&lt;video&gt;</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ã€‚æˆ‘ä»¬é‡‡ç”¨è¿™ç§æ ¼å¼æ˜¯ä¸ºäº†æé«˜å¯è¯»æ€§ã€‚æˆ‘ä»¬çš„æ•°æ®é›†å®ç°è¶³å¤Ÿé€šç”¨ï¼Œå¯ä»¥æ”¯æŒæ­¤æ ¼å¼çš„å˜ä½“ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªæ ·æœ¬ä¸­åŒ…å«å¤šä¸ªå›¾åƒ/è§†é¢‘è¾“å…¥ã€çº¯æ–‡æœ¬æ ·æœ¬ç­‰ã€‚æ›´å¤šè¯¦æƒ…ï¼Œè¯·å‚é˜…</font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/example_data" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;">æ•°æ®</font></a></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/docs/dataset.md" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">é›†æ–‡æ¡£</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ï¼Œäº†è§£æ­¤ JSON æ–‡ä»¶çš„çµæ´»æ€§ã€‚example_data ä¸‹è¿˜æœ‰å¤šä¸ªç¤ºä¾‹ JSON æ–‡ä»¶</font><font style="box-sizing: border-box; vertical-align: inherit;">å¯ä¾›å‚è€ƒã€‚</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/example_data" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"></font></a><font style="box-sizing: border-box; vertical-align: inherit;"></font></p><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">é™¤äº†è¿™ä¸ª json æ–‡ä»¶ä¹‹å¤–ï¼Œå®é™…çš„è§†é¢‘å’Œå›¾ç‰‡é»˜è®¤å­˜å‚¨åœ¨ç›¸åº”çš„æ–‡ä»¶å¤¹ä¸­ï¼Œå› æ­¤ json æ–‡ä»¶ä¸­çš„è·¯å¾„åº”è¯¥æ˜¯ç›¸å¯¹äºè§†é¢‘/å›¾ç‰‡æ ¹æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚æˆ–è€…ï¼Œè·¯å¾„ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ã€‚</font></font></p><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><g-emoji class="g-emoji" alias="warning" style="box-sizing: border-box; display: inline-block; min-width: 1ch; font-family: &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 1.25em; font-weight: 400; line-height: 1; vertical-align: -0.075em; font-style: normal !important;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">âš ï¸</font></font></g-emoji><span>&nbsp;</span><strong style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">å¦‚æœæ‚¨çš„è®­ç»ƒæ•°æ®é›†ä¸­åŒ…å«çº¯æ–‡æœ¬æ¡ç›®ï¼š</font></font></strong><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">å¦‚æœ 1) æ‚¨çš„æ¡ç›®æ•°ä¸º 1ï¼Œæˆ– 2) çº¯æ–‡æœ¬å®ä¾‹çš„æ•°é‡è¶…è¿‡å¤šæ¨¡æ€å®ä¾‹çš„æ•°é‡ï¼Œåˆ™è®­ç»ƒå¯èƒ½ä¼šåœ¨æŸä¸ªæ—¶åˆ»å¤±è´¥</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">per_device_batch_size</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ã€‚è¿™æ˜¯ç”±äº Deepspeed çš„é™åˆ¶/é”™è¯¯é€ æˆçš„ã€‚å¦‚æœä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬ä¼šä¸ºæ‚¨æä¾›å¸®åŠ©ã€‚</font></font></p></details>

<details open="" style="box-sizing: border-box; display: block; margin-top: 0px; margin-bottom: 16px;"><summary style="box-sizing: border-box; display: list-item; cursor: pointer;"><b style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">2. è¿›è¡Œå¾®è°ƒ</font></font></b></summary><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ä¿®æ”¹ç¤ºä¾‹è®­ç»ƒ bash è„šæœ¬</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/example_scripts/example_video.sh" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">example_video.sh</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æˆ–</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/example_image.sh" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">example_image.sh</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ï¼ˆé™¤äº†æ¨¡å‹ ID å’Œæ•°æ®é›†æ–‡ä»¶è·¯å¾„ä¸åŒå¤–ï¼Œä¸¤è€…æ²¡æœ‰åŒºåˆ«ï¼‰ï¼Œä»¥æŒ‡å®šåŒ…æ‹¬ç›®æ ‡æ¨¡å‹ã€æ•°æ®è·¯å¾„ç­‰å‚æ•°ã€‚è„šæœ¬ä¸­æä¾›äº†æ³¨é‡Šï¼Œè§£é‡Šäº†æ¯ä¸ªå‚æ•°çš„å«ä¹‰ã€‚ç„¶åï¼Œåªéœ€è¿è¡Œ bash è„šæœ¬</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">bash example_scripts/example_video.sh</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æˆ–å³å¯å¼€å§‹è®­ç»ƒ</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">bash example_scripts/example_image.sh</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ã€‚è¯·æ³¨æ„ï¼Œè¦å‡†ç¡®è¿è¡Œæä¾›çš„</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/example_scripts/example_video.sh" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">example_video.sh</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">è„šæœ¬ï¼Œæ‚¨éœ€è¦ä» ShareGPT4Video ä¸‹è½½è§†é¢‘ç‰‡æ®µï¼›è¯·å‚é˜…</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/example_data/videos/ego4d/README.md" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">çš„è¯´æ˜ã€‚</font></font></p><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ğŸ“ˆ</font></font><em style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">å¦‚æœæ‚¨æ›´å–œæ¬¢å›¾å½¢ç•Œé¢</font></font></em><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">ï¼Œåªéœ€è¿è¡Œ</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">python webui.py</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">å³å¯å¯åŠ¨ gradio ç•Œé¢è¿›è¡Œå¾®è°ƒã€‚</font></font></p></details>

<details open="" style="box-sizing: border-box; display: block; margin-top: 0px; margin-bottom: 16px;"><summary style="box-sizing: border-box; display: list-item; cursor: pointer;"><b style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">3. ä½¿ç”¨å¾®è°ƒæ¨¡å‹è¿›è¡Œæ¨ç†</font></font></b></summary><p dir="auto" style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">è¿™é‡Œçš„å…³é”®æ˜¯æ­£ç¡®åŠ è½½ç»è¿‡å¾®è°ƒçš„æ¨¡å‹ï¼Œä¹‹åçš„ä¸€åˆ‡æ“ä½œéƒ½ä¸ä½¿ç”¨ Huggingface çš„ç›¸åº”æ¨¡å‹è¿›è¡Œæ¨ç†ç›¸åŒã€‚è¯·å‚é˜…</font></font><a href="https://github.com/JackyLiuAI/lmms-ft/blob/main/docs/inference.md" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æ¨ç†æ–‡æ¡£</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¦‚ä½•</font></font><code style="box-sizing: border-box; font-family: &quot;Monaspace Neon&quot;, ui-monospace, SFMono-Regular, &quot;SF Mono&quot;, Menlo, Consolas, &quot;Liberation Mono&quot;, monospace; font-size: 13.6px; padding: 0.2em 0.4em; margin: 0px; white-space: break-spaces; background-color: rgba(129, 139, 152, 0.12); border-radius: 6px;">merge_lora_weights.py</code><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">è½»æ¾è·å–ç‹¬ç«‹æ¨¡å‹ã€‚æ‚¨ä¹Ÿå¯ä»¥å‚è€ƒ</font></font><a href="https://colab.research.google.com/drive/139XypY8_wdLgyLXYE_Zve7Hjd809fVpK?usp=sharing" rel="nofollow" style="box-sizing: border-box; background-color: rgba(0, 0, 0, 0); color: rgb(9, 105, 218); text-decoration: underline; text-underline-offset: 0.2rem;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">æ­¤ Colab</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">è·å–å®Œæ•´ç¤ºä¾‹ã€‚</font></font></p></details>

## è‡´è°¢



æˆ‘ä»¬è¦æ„Ÿè°¢ huggingface å›¢é˜Ÿç§¯æåœ°å°†æœ€æ–°æ¨¡å‹é›†æˆåˆ° Transformers åº“ä¸­ã€‚æ­¤å¤–ï¼ŒHF å‘˜å·¥[Niels Rogge](https://github.com/NielsRogge)å’Œ[Raushan Turganbayç¼–å†™çš„ç¤ºä¾‹å¾®è°ƒè„šæœ¬ï¼ˆä¾‹å¦‚](https://github.com/zucchini-nlp)[è¿™ä¸ª](https://github.com/NielsRogge/Transformers-Tutorials/blob/master/LLaVa/Fine_tune_LLaVa_on_a_custom_dataset_(with_PyTorch_Lightning).ipynb)ã€[è¿™ä¸ª](https://github.com/NielsRogge/Transformers-Tutorials/blob/master/LLaVa-NeXT/Fine_tune_LLaVaNeXT_on_a_custom_dataset_(with_PyTorch_Lightning).ipynb)å’Œ[è¿™ä¸ª](https://colab.research.google.com/drive/1dTdro-k7NFqRgGq5-TlGHM-6k2sYQhXp#scrollTo=4ccbd183-f15a-4f94-a526-9ceeec3f61e0)ï¼‰éå¸¸æœ‰ç”¨ï¼Œä¸ºè¿™ä¸ªä»£ç åº“å¥ å®šäº†åŸºç¡€ã€‚æˆ‘ä»¬è¿˜è¦ç‰¹åˆ«æ„Ÿè°¢[Raushan Turganbay](https://github.com/zucchini-nlp)å¯¹æ­¤é¡¹ç›®çš„æ…·æ…¨è®¨è®ºå’Œåé¦ˆã€‚

è¯¥ä»£ç åº“å€Ÿé‰´ã€å¯å‘æˆ–å»ºç«‹åœ¨ä»¥ä¸‹ä»£ç ã€å­˜å‚¨åº“å’Œ/æˆ–åº“ä¹‹ä¸Šï¼š[LLaVA](https://github.com/haotian-liu/LLaVA)ã€[Qwen](https://github.com/QwenLM/Qwen-VL/blob/master/finetune.py)ã€[transformers](https://github.com/huggingface/transformers)ç­‰ã€‚

## å¼•æ–‡

å¦‚æœæ‚¨åœ¨ç ”ç©¶/é¡¹ç›®ä¸­ä½¿ç”¨ lmms-finetuneï¼Œæˆ‘ä»¬å°†éå¸¸é«˜å…´æ‚¨å¯ä»¥ 1ï¼‰ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ˜Ÿï¼Œ2ï¼‰ä¸å…¶ä»–äººåˆ†äº«è¿™ä¸ª repoï¼Œæˆ– 3ï¼‰å¼•ç”¨è¿™ä¸ªä»£ç åº“ï¼š

```
@software{Zhang_lmms-finetune,
author = {Zhang, Jingyang and Lin, Yueqian},
license = {Apache-2.0},
title = {{lmms-finetune}},
url = {https://github.com/zjysteven/lmms-finetune}
}
```

